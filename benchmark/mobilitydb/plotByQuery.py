import pandas as pd
import matplotlib.pyplot as plt

# Benchmark data
data = """
spatial_surrounding,50,1739470700.6635816,1739470701.0613387,0.39775705337524414
spatial_bounding_box,50,1739470701.1976047,1739470701.268899,0.07129430770874023
spatial_bounding_box,50,1739470701.197649,1739470701.2755399,0.07789087295532227
spatial_polygonal_area,50,1739470701.463704,1739470701.5543976,0.09069347381591797
spatial_polygonal_area,50,1739470701.4649453,1739470701.5575945,0.09264922142028809
spatial_nearest_neighbor,50,1739470701.7918766,1739470701.844104,0.05222749710083008
spatial_nearest_neighbor,50,1739470701.7918248,1739470701.8508701,0.05904531478881836
spatial_surrounding,50,1739470700.6637163,1739470701.8845456,1.2208292484283447
spatial_clustering,50,1739470701.9408336,1739470714.6431742,12.702340602874756
spatial_clustering,50,1739470701.9402354,1739470718.2492673,16.30903196334839
spatial_line_proximity,50,1739470718.3612943,1739470718.598294,0.2369997501373291
spatial_line_proximity,50,1739470718.361305,1739470728.2969751,9.935670137405396
spatial_ride_traffic,50,1739470728.38939,1739470728.7911642,0.40177416801452637
spatial_ride_traffic,50,1739470728.3893654,1739470728.889052,0.49968647956848145
temporal_trip_duration,50,1739470729.2138717,1739470730.8782992,1.6644275188446045
temporal_trip_duration,50,1739470729.214057,1739470730.882305,1.668247938156128
spatiotemporal_avg_trip_speed,50,1739470730.9638138,1739470731.078589,0.11477518081665039
spatiotemporal_avg_trip_speed,50,1739470730.9645295,1739470731.0786247,0.11409521102905273
attribute_value_filter_points,50,1739470734.519671,1739470735.275973,0.7563021183013916
attribute_value_filter_points,50,1739470734.519536,1739470735.2840383,0.7645022869110107
attribute_value_filter_trips,50,1739470735.3640058,1739470735.3989172,0.034911394119262695
attribute_value_filter_trips,50,1739470735.3639483,1739470735.3989713,0.03502297401428223
temporal_time_interval,50,1739470735.488525,1739470736.338936,0.8504111766815186
temporal_time_interval,50,1739470735.4884577,1739470736.3914673,0.9030096530914307
spatiotemporal_spatial_surrounding,50,1739470736.476758,1739470736.56036,0.0836019515991211
temporal_interval_around_timestamp,50,1739470736.6590543,1739470737.6307895,0.9717352390289307
temporal_interval_around_timestamp,50,1739470736.6529377,1739470737.639542,0.9866044521331787
spatiotemporal_spatial_surrounding,50,1739470736.477897,1739470738.2152224,1.7373254299163818
temporal_count_points_in_time_range,50,1739470737.73419,1739470738.6830196,0.9488296508789062
temporal_count_points_in_time_range,50,1739470737.7342477,1739470738.7061975,0.9719498157501221
spatiotemporal_average_speed_in_time_range,50,1739470738.7947636,1739470739.6744823,0.8797187805175781
spatiotemporal_average_speed_in_time_range,50,1739470738.7949176,1739470739.728401,0.933483362197876
spatiotemporal_event_duration_in_region,50,1739470739.7651885,1739470739.810707,0.04551863670349121
spatiotemporal_event_duration_in_region,50,1739470739.7652755,1739470739.816787,0.051511526107788086
temporal_peak_activity_times,50,1739470739.8987832,1739470742.428291,2.529507875442505
temporal_peak_activity_times,50,1739470739.8976848,1739470742.4288962,2.5312113761901855
spatiotemporal_historical_spatiotemporal,50,1739470742.636012,1739470742.6714787,0.035466670989990234
spatiotemporal_historical_spatiotemporal,50,1739470742.6352258,1739470742.7122943,0.07706856727600098
spatial_surrounding,50,1739470762.9424376,1739470762.9779706,0.03553295135498047
spatial_surrounding,50,1739470762.943195,1739470763.12834,0.18514490127563477
spatial_bounding_box,50,1739470763.0671365,1739470763.128722,0.061585426330566406
spatial_bounding_box,50,1739470763.0681732,1739470763.15179,0.08361673355102539
spatial_polygonal_area,50,1739470763.2172651,1739470763.2540944,0.036829233169555664
spatial_polygonal_area,50,1739470763.2173078,1739470763.254128,0.036820173263549805
spatial_nearest_neighbor,50,1739470763.3405874,1739470763.3833497,0.04276227951049805
spatial_nearest_neighbor,50,1739470763.3413444,1739470763.383598,0.042253732681274414
spatial_clustering,50,1739470763.4707441,1739470774.8243377,11.353593587875366
spatial_clustering,50,1739470763.4708865,1739470774.9170752,11.446188688278198
spatial_line_proximity,50,1739470775.0057027,1739470777.1643145,2.15861177444458
spatial_ride_traffic,50,1739470777.2558131,1739470777.795624,0.5398108959197998
spatial_ride_traffic,50,1739470777.2563255,1739470777.7957535,0.5394279956817627
temporal_trip_duration,50,1739470778.130032,1739470779.7265666,1.5965344905853271
temporal_trip_duration,50,1739470778.1302779,1739470779.8621304,1.7318525314331055
spatiotemporal_avg_trip_speed,50,1739470779.8170865,1739470779.9364097,0.1193232536315918
spatiotemporal_avg_trip_speed,50,1739470779.8187222,1739470779.9371538,0.11843156814575195
attribute_value_filter_points,50,1739470783.4852784,1739470784.262192,0.7769136428833008
attribute_value_filter_points,50,1739470783.4830139,1739470784.2716033,0.7885894775390625
attribute_value_filter_trips,50,1739470784.3494954,1739470784.384512,0.035016536712646484
attribute_value_filter_trips,50,1739470784.3493989,1739470784.3843284,0.034929513931274414
temporal_time_interval,50,1739470784.4753947,1739470785.3862238,0.9108290672302246
temporal_time_interval,50,1739470784.475509,1739470785.4143524,0.9388434886932373
spatiotemporal_spatial_surrounding,50,1739470785.5085466,1739470786.9284384,1.4198918342590332
spatiotemporal_spatial_surrounding,50,1739470785.5087166,1739470787.4519548,1.9432382583618164
temporal_interval_around_timestamp,50,1739470787.5568,1739470788.6400754,1.083275556564331
temporal_interval_around_timestamp,50,1739470787.5584197,1739470788.658043,1.099623203277588
temporal_count_points_in_time_range,50,1739470788.7805772,1739470790.2177272,1.437150001525879
temporal_count_points_in_time_range,50,1739470788.7775285,1739470790.2301607,1.452632188796997
spatiotemporal_average_speed_in_time_range,50,1739470790.3387246,1739470791.765555,1.4268302917480469
spatiotemporal_average_speed_in_time_range,50,1739470790.3414636,1739470791.8538287,1.5123651027679443
spatiotemporal_event_duration_in_region,50,1739470792.013244,1739470792.0836952,0.07045125961303711
spatiotemporal_event_duration_in_region,50,1739470792.015615,1739470792.0857587,0.0701436996459961
temporal_peak_activity_times,50,1739470792.248533,1739470796.2926319,4.044098854064941
temporal_peak_activity_times,50,1739470792.2461798,1739470796.4382174,4.192037582397461
spatiotemporal_historical_spatiotemporal,50,1739470796.593081,1739470796.6674125,0.07433152198791504
spatiotemporal_historical_spatiotemporal,50,1739470796.5944786,1739470797.6836145,1.0891358852386475
spatial_line_proximity,50,1739470775.00568,1739470798.5298011,23.524121046066284
temporal_trips_starting_after_timestamp,50,1739541046.8123477,1739541047.0007775,0.1884298324584961
temporal_trips_starting_after_timestamp,50,1739541046.8124177,1739541047.000625,0.18820714950561523
temporal_trips_starting_after_timestamp,50,1739567132.9163861,1739567133.346734,0.43034791946411133
temporal_trips_starting_after_timestamp,50,1739567132.916574,1739567133.4877412,0.5711672306060791
"""

# Load the data into a pandas DataFrame
from io import StringIO
df = pd.read_csv(StringIO(data), header=None, names=["query_type", "limit", "start_time", "end_time", "duration"])

avg_durations = df.groupby("query_type")["duration"].mean()

# Plot the results
plt.figure(figsize=(10, 6))
avg_durations.plot(kind="bar", color="lightcoral", edgecolor="black")


plt.title("Average Query Execution Time by Query Type", fontsize=16)
plt.ylabel("Duration (seconds)", fontsize=14)
plt.xlabel("Query Type", fontsize=14)
plt.xticks(rotation=45, ha="right", fontsize=12)
plt.grid(axis="y", linestyle="--", alpha=0.7)

plt.tight_layout()
plt.show()
